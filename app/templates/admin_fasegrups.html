<!DOCTYPE html>
<html lang="ca">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
<title>Fase de Grups</title>

<style>
/* ==============================
   üíª ESTIL ORIGINAL (PC)
   ============================== */
body {
    font-family: Arial, sans-serif;
    background: #f7f7f7;
    padding: 20px;
}

h1 {
    color: #800000;
    text-align: center;
    margin-bottom: 10px;
    font-size: 32px;
}

.back-container {
    text-align: left;
    margin: 10px 0 25px 10px;
}

.back-btn {
    display: inline-block;
    background-color: #800000;
    color: white;
    font-weight: bold;
    padding: 10px 18px;
    border-radius: 6px;
    text-decoration: none;
    font-size: 15px;
    box-shadow: 2px 2px 5px rgba(0,0,0,0.2);
    transition: 0.2s;
}

.back-btn:hover { background:#a00000; }

/* Taula partits */
table {
    border-collapse: separate;
    border-spacing: 0 6px;
    margin: 15px auto;
    background:#fff;
    width: 85%;
    box-shadow:0 0 5px rgba(0,0,0,0.1);
}

th {
    background:#800000;
    color:white;
    padding:8px 10px;
    border:none;
    font-size:16px;
}

th, td {
    text-align:center;
}

td {
    padding:6px 10px;
    border-top:1px solid #ddd;
    border-bottom:1px solid #ddd;
    font-size:15px;
}

tr:nth-child(even) { background-color:#fafafa; }

/* Columnes */
td.id { width:60px; font-weight:bold; }
td.equip1 { text-align:right; padding-right:15px; font-weight:600; }
td.equip2 { text-align:left; padding-left:15px; font-weight:600; }

input[type="number"] {
    width:55px;
    text-align:center;
    padding:3px;
    border:1px solid #ccc;
    border-radius:4px;
}

button, .btn {
    background:#800000;
    color:white;
    border:none;
    padding:8px 16px;
    margin:6px;
    border-radius:6px;
    cursor:pointer;
    font-size:16px;
}

.btn-danger { background:#555; }

/* ==============================
   üìä CLASSIFICACI√ì
   ============================== */
.table-wrapper { overflow-x:auto; width:100%; }

table.classificacio {
    width:70%;
    margin:30px auto;
    background:white;
    border-spacing:0 5px;
    box-shadow:0 0 6px rgba(0,0,0,0.1);
    min-width:700px;
}

/* ==============================
   üì± M√íBIL
   ============================== */
@media (max-width:600px) {
    body { padding:12px; }
    h1 { font-size:26px; }
    table { width:100%; min-width:700px; }
    th, td { font-size:16px; padding:10px; }
    input[type="number"] { width:60px; padding:6px; font-size:16px; }
    button, .btn { width:90%; font-size:18px; padding:14px; }
    .btn-danger { font-size:18px; }
}

/* ==============================
   üì≤ TABLET
   ============================== */
@media (min-width:600px) and (max-width:1024px) {
    table { width:90%; }
    h1 { font-size:30px; }
}
</style>
</head>

<body>

<h1>FASE DE GRUPS</h1>

<div class="back-container">
    <a href="{{ url_for('main.admin_menu') }}" class="back-btn">‚¨Ö Tornar</a>
</div>

<form method="POST">

<div style="text-align:center;">
    <label>SELECCIONA GRUP:</label>
    <select name="grup" onchange="this.form.submit()">
        {% for g in grups %}
        <option value="{{ g }}" {% if g == grup_id %}selected{% endif %}>
            Grup {{ g }}
        </option>
        {% endfor %}
    </select>

    <button name="generar">Generar partits</button>
</div>

{% if msg %}
    <p style="color:green; text-align:center;">{{ msg }}</p>
{% endif %}
{% if error %}
    <p style="color:red; text-align:center;">{{ error }}</p>
{% endif %}

<div style="text-align:center; margin:14px;">
    <a href="{{ url_for('admin_bd.descarregar_pdf_grup', grup_id=grup_id) }}"
       class="btn btn-danger" target="_blank">
       üìÑ Descarregar PDF del grup {{ grup_id }}
    </a>
</div>

{% if partits %}
<div style="text-align:center; margin-top:20px;">

    <h3 style="font-weight:bold; font-size:26px; color:#800000; margin-bottom:5px;">
        GRUP {{ grup_id }}
        {% if pista %}
            <span style="font-weight:bold; font-size:26px; color:#800000; margin-left:15px;">
               üèê Pista {{ pista }}
            </span>
        {% else %}
            <span style="color:#999; font-size:22px; font-style:italic; margin-left:15px;">
                | Sense pista
            </span>
        {% endif %}
    </h3>

</div>

<div class="table-wrapper">
<table>
<thead>
<tr>
    <th>ID</th>
    <th>Equip 1</th>
    <th>P1</th>
    <th>P2</th>
    <th>Equip 2</th>
    <th>√Ärbitre</th>
</tr>
</thead>

<tbody>
{% for p in partits %}
<tr>
    <td class="id">{{ loop.index }}.{{ grup_id }}</td>
    <td class="equip1">{{ p[1] }}</td>
    <td><input type="number" name="p1_{{ p[0] }}" value="{{ p[4] }}" min="0"></td>
    <td><input type="number" name="p2_{{ p[0] }}" value="{{ p[5] }}" min="0"></td>
    <td class="equip2">{{ p[2] }}</td>
    <td>{{ p[3] or '-' }}</td>
</tr>
{% endfor %}
</tbody>
</table>
</div>

<div style="text-align:center;">
    <button name="guardar">üíæ Guardar resultats</button>
</div>

{% else %}
<p style="text-align:center;">No hi ha partits generats per aquest grup.</p>
{% endif %}
</form>

{% if classificacio %}
<h3 style="text-align:center; margin-top:40px; color:#800000;">Classificaci√≥ Grup {{ grup_id }}</h3>

<div class="table-wrapper">
<table class="classificacio">
    <thead>
        <tr>
            <th>#</th>
            <th>Equip</th>
            <th>PJ</th>
            <th>Punts</th>
            <th>PF</th>
            <th>PC</th>
            <th>DIF</th>
        </tr>
    </thead>
    <tbody>
        {% for eq, stats in classificacio %}
        <tr>
            <td><b>{{ loop.index }}</b></td>
            <td>{{ eq }}</td>
            <td>{{ stats.pj }}</td>
            <td>{{ stats.punts }}</td>
            <td>{{ stats.favor }}</td>
            <td>{{ stats.contra }}</td>
            <td><b>{{ stats.diferencia }}</b></td>
        </tr>
        {% endfor %}
    </tbody>
</table>
</div>
{% endif %}

</body>
</html>